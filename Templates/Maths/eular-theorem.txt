

a^b % m = (a ^ (b % etf(m)))%m

where etf is eular-totient-function